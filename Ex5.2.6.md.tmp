略解: O(n)

まじめに考えようと思ったが評価のステップ数か……
いったんあとで。
